**背景简介**
笔记是对于**博士论文《基于模型泛化的图像处理技术研究 》**（2021年）的学习记录总结与扩展，笔记标题所指的第二章，对应该论文**第二章：基于子批移除算法的图像处理技术**

论文作者：孙若琪 上海交通大学
导师：马利庄（杰青），其团队拥有数字媒体与计算机视觉实验室，与腾讯和商汤科技深度合作。在计算机视觉顶会ICCV 2023公布录用名单中，上海交通大学电子信息与电气工程学院计算机系马利庄教授团队共有10篇论文录用。其团队与多家行业领衔的AI公司合作，研发健康码、远程身份核实系统等系列产品

相关链接：
1.[为腾讯健康码辨人脸，上海交大这个团队获上海科技进步特等奖 (thepaper.cn)](https://m.thepaper.cn/newsDetail_forward_12837596)
2.[马利庄团队简介：][数字媒体和计算机视觉实验室 (sjtu.edu.cn)](https://dmcv.sjtu.edu.cn/)

# 1. CIFAR数据集

CIFAR-10 包含 10 个类。数据集中，训练集和测试集分别有 50000 和10000 张图像。图像尺寸为32x32像素

下载地址：pytorch官网[[Search — Torchvision 0.19 documentation (pytorch.org)](https://pytorch.org/vision/stable/search.html?q=CIFAR&check_keywords=yes&area=default)]

![[Pasted image 20241011193048.png]]

# 2. 对CIFAR数据集中的图片进行操作
## 2.1 最大池化
个人理解：模糊化图片（1080p->720p），保留图片的最主要的特征，减少矩阵计算量
###  2.1.1 代码实现
代码实现的功能是对CIFAR数据集中的图片进行最大池化的操作

```python
import torchvision
from torch import nn
from torch.nn import MaxPool2d
from torch.utils.data import DataLoader
from torch.utils.tensorboard import SummaryWriter

# 加载CIFAR10数据集
dataset = torchvision.datasets.CIFAR10("./dataset", train=False, transform=torchvision.transforms.ToTensor(), download=True)

dataloader = DataLoader(dataset, batch_size=64)

# 搭建网络
class Tudui(nn.Module):
    def __init__(self):
        super(Tudui, self).__init__()
        self.maxpool1 = MaxPool2d(kernel_size=3, ceil_mode=False)

    def forward(self, input):
        output = self.maxpool1(input)
        return output

# 初始化TensorBoard和模型
writer = SummaryWriter("logs")  # 日志文件存储位置
tudui = Tudui()
print(tudui)

# 遍历数据集，进行池化操作并记录结果
step = 0
for data in dataloader:
    imgs, targets = data
    output = tudui(imgs)
    print("原图像的形状", imgs.shape)
    print("池化之后图像的形状", output.shape)
    writer.add_images("maxpool_input", imgs, step)
    writer.add_images("maxpool_output", output, step)
    step = step + 1

# 关闭TensorBoard
writer.close()
```

### 2.1.2 效果图（在TensorBoard中）：
以第24轮为例，图中的input是对于CIFAR数据集中图片的直接输出，经过池化操作以后，图片明显变得更加模糊。但是对计算机来说，这样的图片已经具备可以提取的特征，并且可以简化计算

![[d4ecf3b54291839c464cb53631fc225c.png]]


## 2.2 非线性激活
能够引入非线性的特性，使得神经网络具有更强的表达能力和适应能力，增强鲁棒性
### 2.2.1 代码实现
主要是为了实现对于CIFAR10数据集中图片的**非线性映射**（Sigmoid函数实现）任意实数值的输入映射到(0,1)区间内的输出，非线性映射使神经网络能够处理复杂的非线性问题。

```python
import torchvision
from torch import nn
from torch.nn import Sigmoid
from torch.utils.data import DataLoader
from torch.utils.tensorboard import SummaryWriter

# 加载CIFAR10数据集
dataset = torchvision.datasets.CIFAR10("./dataset", train=False, transform=torchvision.transforms.ToTensor(),download=True)
dataloader = DataLoader(dataset, batch_size=64)

# 搭建网络
class Tudui(nn.Module):
    def __init__(self):
        super(Tudui, self).__init__()
        self.sigmoid1 = Sigmoid()

    def forward(self, input):
        output = self.sigmoid1(input)
        return output

# 初始化TensorBoard和模型
writer = SummaryWriter("logs")  # 日志文件存储位置
tudui = Tudui()
print(tudui)

# 遍历数据集，应用激活函数并记录结果
step = 0
for data in dataloader:
    imgs, targets = data
    output = tudui(imgs)
    writer.add_images("before_activate", imgs, step)
    writer.add_images("after_activate", output, step)
    step += 1

# 关闭TensorBoard
writer.close()
```

### 2.2.2 实现效果
	在pycharm中编译过后，在本地端口打开Tensorboard

![[433bf52d2220f9697a6d61a12c29d02e.png]]